/**
	Template by Akikaze (秋風) - formerly proptit_4t41.
	Code written by a random fan of momocashew and Chiho.
	
	H△G x Mili - November 27th, 2013
	Mag Mell (Mili) - Sep 17th, 2014
	H△G x Mili Vol.2 - May 9th, 2015
	Miracle Milk (Mili) - Oct 12th, 2016
	青色フィルム (H△G) - February 14th, 2018
	Millennium Mother (Mili) - April 25th, 2018
**/



/** Ai-chan is just kawaii :"> <3 **/

/**
###################################i::;;;;;;;,:;;,:;,;;;;;;;;;;;;;;;;;;;;;;;j;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;::;###########################
###################################i::;;;;;;::;;;:,;;;;;;;;;;;;;;;;;;;;;;;;;;j;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;::,.##########################
###################################j:;;;;;;::;;;;:,;;;;;;;;;;;;;;;;;;;;;;;;;;;i;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::,##########################
###################################;:;;;;t:,;;;;,,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;i;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;::: ##########################
###################################:,;;;j,,;;;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;j;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;j;;;;;:::;##########################
##################################.,;;;i:,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;i;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;i;;;;:,,t##########################
##################################j,;;,,,;;;;;;t;;;;;;;;;:;;;;;;;;;;;;;;;;;;;;;;;;;;f;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,t;;;,,:W##########################
##################################;;i:,;;;;;;;j;;;;;;;;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;i;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,i;;,,:j##########################
#################################j,t,,,;;;;;;;;;;;;;;;;;;,;i;;;;;;;;;;;;;;;;;;;;;;;;;;;f;;;;;;;;;;;;;;;;;;;;;;;;f;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,;;,,:;##########################
#################################jL,,;;i;;ii;t;;;;;;;;;i,,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;t;;;;;;;;;;;;;;;;;;;;;;;i;;;;;;;;;;;;;;;;;;;;;;;;;;;;,:;,,,,##########################
################################.,,,;iiiiiiij;;iiiii;ii;,,;;;t;ii;;;;;;;;i;;;;;;;;;;;;;i;;t;;;;i;;;;;;;;;;;;;;;;;i;;;i;;;;;j;;;;;;;;;;;;;;iiii;,,,,,.##########################
###############################t:,,iiiiiiiii,iiiiiiiiii;,,,iiij;;;i;iii;;iii;;;i;;;;;i;i;i;;f;;;;ii;;i;iii;iiiii;iji;;;;;;it;;iiiiiii;iiiiiiiii;,,:,.##########################
############################# j,,,iiiiiiiiijiiiiiiiiiiii,,,iiiiLiiiiiiit;iiiiiiiiiiiiiiiiii;;;f;iiiiiiiiiiiiiiiiiiit;itiiii;;iiiiiiiiiiiiiiiiiii;,:::##########################
############################i:,,,iiiiiiiiii,iiiiiiiiiiiL,,,iiiiitiiiiiiiifiiiiiiiiiiiiiiiiiiii;;L;iiiiiiiiiiiiiiiii;ii;;iiiiiiiiiiiiiiiiiiiiiiiii,,:;##########################
##########################;f,,,;iiiiiiiiii,iiiiiiiiiiiij,,,;iiiii;fiiiiiiiifiiiiiiiiiiiiiiiiiiiiiif;iiiiiiiiiiiiiiiifiiLiiiifiiiiiiiiiiiiiiiiiiiii,,:,#########################
##########################f,,,;iiiiiiiiiif,iiiiiiiiiiii,,,,,iiiiiiitiiiiiiiiijiiiiiiiiiiiiiiiiiiiiiiiL;iiiiiiiiiiiiiiiiiiiiiLiiiiiiiiiiiiiiiiiitiii,,,.########################
##########################i,,,iiiiiiiiiii,i;iiiiiiiiiii,;,,,iiiiiiiiiLiiiiiiiijiiiiiiiiiiiiiiiiiiiiiii;G;iiiiiiiiiiiiLiiiiiifiiiiiiiiiiiiiiiiii;iii,,,j########################
##########################;,,,iiiiiiiiiiL,iLiiiiiiiiiii,i,,,;iiiiiiiii;LiiiiiiiiiL;iiiiiiiiiiiiiiiiiiiiiiiGiiiiiiiiiiiiitiiijiiiiiiiiiiiiiiiiiiijiii,,,########################
##########################,,,,iiiiiiiiii,;iiiiiiiiiiiii,ii,,,iiiiiiiiiiiifiiiiiiiiiiLiiiiiiiiiiiiiiiiiiiiiiiiLfiiiiiiitiLiiiiiiiiiiiiiiiiiiiiiii,iii,,;########################
##########################i,,,iiiiiiiiit,ifiiiiiiiiiiiG,ii,,,iiiiiiiLiiiiiiifjiiiiiiiiitLLtiiiiiiiiiiiiiitfLfiiiiiiiiijitiiiiiiiiiiiiiiiiiiiiiii,iii,,t########################
##########################G,,,;iiiiiiii,,itiiiiiiiiiiii,iii,,,iiiiiitfiiiiiLiiiitjLLjtiiiiijLLjjttttiL;iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii;Lii,,L########################
##########################.,,,;iiiiiiit,iiiiiiiiiLiiifi,iit,,,iiiiiii,jiiiiiiiiiLiiiiiiiiiL,:;LtiiiiiiiGjiiiiGiiiiiiiiifitiiiiiiiiiiiiiiiiiiiiiii,ii,,f########################
###########################j,,,iiiiiii,,iLiiiiiiiiiiiji,iifi,,,iiiiiiG,iiiiiGiiiiffiiiiiiiiii,,jfijiiiii:.Liiifiiiiiiiitifiiiiiiiiiiiiiiiiiiiiiii,i;,,;########################
###########################i,,,iiiiiiL,,itiiiiiiiiiiiit;iiGi,,,iiiiiii,;iiiiiiiiii,,jiiiiiiiif;,:.::Ltiii.:.;tifiiiiiiiiiLiiiiiiiiiiiiiiiiiiiiiii,G,,,K########################
############################,,,iiiiii,,iiiiiiiiiiiiiiiLiiifii,,,iiiiiii,LiiiiGiiiii,,:fiiiiiiiif,,:.::,iii::::itLiiiiiiijGiiiiiiiiiiiiiiiiiiiiiii,,,,,#########################
############################G,,iiiiii,,itiiiiiiitiiiLiLiiitii,,,iiiiiif,.iiiiiLiiiif,::LLiiiiiiiiD,:....LiL::::iLLiiiiiiGLiiiiiiiiiiiiiiiiiiiiiii,,,,,#########################
############################,,,,ttttL,,iGttitiiiGiiiGitjiiiiii,,,iiiiii,,LiiiiifiiiiGfj,..tLiiiiiiiG.:::::i::::.iiLiiiiijfiiiiiiiiiiiiiiiiiiiiiii,,G,j#########################
#############################G,,ittti,;iittttiiiLiiiLiiGiiiGiii,,iiiiiiG,:fiiiL,fiiiiG,.::::.tGiiiiiij:.:::G::..iiitiiiiifiitiiiiiiiiiiiiittttiii,,,,L#########################
############################# ,,ittt,,itittttttttiiiLtiLittftii,,,tittti,,.tiii,,GiitiD:::::::::.jGjiitji:..f:::iiiittitiDiiLiititttti;ittttitit,,,,tW#########################
##############################f,,tti,,tDttttttititifGtt:ttiDLiti,,,iitttf,:GtttGG,;ititG.::::::::::::.:,jGL.:f::jtiiftttiGiiLtttttttti,tttttttti,,,,f##########################
###############################,,ttf,,tjtttttttttttDGif:ittffittt,,;itttt;:.tttD,,,.Lttif:::::::::::::::::::i.j:Lttiijittjtttttttttttt,,tttttttti,,,,##########################
###############################j,;tD,,t,tttttttttttDGiGGLttiLLttti,,tttttt;LGtti,,:::itttf::::::::DDDDEED:::.:::Gitttttttitittitttttti,,ttttttttG,i,,L#########################
################################L,ti,;t,ttttttttttti.tG.Gttt,Dfttt;,,tttttG,,itt,::::::Ljtt:::.DDD  iDDDDEEEG:::jtttttGtttitttttttttt;,,;tttttti;,t,,L#########################
################################D,;;,it,tttttttittt:.tf:.tttLL,tttt,;;ttttt,:tttf::::::::Ljt:EEiE....  D;DEEEEK:iittttittttGtttittttt,,;itttttt;,;t,;G#########################
#################################G;;,it,ttttttttttt::ii.:EttDjEDtttt,,ittttj:jttD::::::G:::.DL,::......D .EfEEE::ttttttDtttttttittttt,,ttittttt,;,t;,;#########################
##################################L,,tt,itttttttttf:.Gt::.ttj;tiLtttt,,tttttG:itf::::L::::j:::,:......., LEj,LE::tLtttttttjtttttitttj,,tt;ttttt,;iti,,#########################
##################################t,,tt,;tttttttttD::,t.::Gtt:;D:jtttt,,ttttt:Dtt::.;::::L,,,............EEE.E.::tDtttttDtEttttt;tttt;;ttttttti;,jtt;,L########################
###################################,;tt;,ttttttjttD::.LL:::ttE:L..ttttt,,ttttt:ti.:::::.;,,............ .ELE.E:::tDttttttiGttttttttt;,ttttittt,,;Gtt,;L########################
###################################,,tt;,ttttttfttGL:::G:::Dtt:.G::ftttt;;ttttLtt,::::::::............. .EtE.::::tLttttttDGttttttttt,;tttt;ttt,;;Gtt;,G########################
###################################,;tt,,ttttttfttLt,::D:EEEti.Gjt::Gttttt;ttttEt;::::,,...............;iELD.::::tttttttttLtttttt;tt,Dtttttttt;,tftt,;G########################
###################################;,ttf;itttttfttjtt:::EE,,GtE::D:::DtttttittttEt::::..........,......fKDE.:::::tttttttttLtttttttti;Dtttttit;;,tjtt,Lt########################
###################################,;ttG;;tttttfjtjttj::LK,,,EtD.:E:::EttttttttttG::::..........:..... .EfE::::::tttttttttftttttttt,,jttttt;t,;;tttt;D,########################
###################################j;itD,;ttttttGtjttt:;KD,. .Dt.t:i:::;jtttttttttG:::...........E... G.KG:::::::Ltttttttttttttttti;;tttttti;;;itttt;f,########################
###################################E;itEE,ttttttEtftttDfE:.....D.D::t::::GtttttttttE:::...........EjtLfE::::::::.Etttttttttttttttt;;ittttttt;;;ttttt;f;G#######################
###################################f;;tD#;,tttttDtLtttt:E,......tE:::L:::::iLtttttttL:::...........EjE:::::::::::jtttfttttttttttttt,tttttttt;;,ttttt;j;G#######################
###################################f,;tE#E;tttttKtDttttGE:.......E::::G::::::.Dttttttt::::..,;tfLLf;::::::::::::.ttttLttttttttttttt,tttttttt;;tttttt;t;D#######################
####################################f;tE#G;;ttttKjEjtttt.f......DE.::::;::::::::.fDttttj:::::::::::::::::::::::::ttttGtttftttttttttitttttttti;tttttt;i;D#######################
####################################E;tG##K;ttttjEGLjtttDf......jKL:::::.::::::::::::::;.:::::::::::::::::::::::GttttDtttfttttttttttttjtttttt;tttttt;i;E#######################
####################################L;tj##G;;ttttDj##Lttt.....E.EKK:::::::::::::i:::::::::::::::::::::::::::::::LjtttEtttLttttttttttttjttttttttttttt;t;E#######################
#####################################t;tG##E,ttttEt##tDttD:... ELEG:::::::::::::f:::::::::::::::::::::::::::::::tGtttEtttLttttttttttttjttttttttttttt;j;E#######################
#####################################E;tf###j;tttLDG#tLLtt:....ijD:::::::::::::::::::::::::::::::::::::::::::::.tDtttGtttLttttttttttttjttttttttttttt;f;K#######################
######################################;tK###G,;tttGW#tD;tEi:j ..E::::::::::::::::::::::::::::::::::::::::::::::GtLtttjtttGttttttttttttjttttttttttttt;f;K#######################
######################################Dif####G,;ttEKEtEjtGf::::.:::::::::::::::::::::::::::::::::::::::::::::::ftttttttttGtttttttttttttttttttttttftt;G;E#######################
#######################################GtL####L;;ttD#tKW;Et::::::::::::::::::::::::::::::::::::::::::::::::::::ttttttttttEtttttttttttttttttttttttDtt;G;D#######################
#######################################.LE######D;tEKtLE;Gtj::::::::::::::::::::::::::::::::::::::::::::::::::;ttttttttttEtttttttttttttttttttttttDtt;j;D#######################
#########################################G#######D;tKtf#;fiL::::::::::::::::::::::::::::::::::::::::::::::::::GtttttfttttGtttttttttttttttttttttttttt;;;G#######################
#########################################GG########KjK##tj;j,:::::::::::::::::::::::::::::::::::::::::::::::::ttDtttEttttjttttttttttfttttttttttttttt;;;D#######################
####################################################GKE#Dt;.:::::::::::::::::::::::::::::::::::::::::::::::::,ttLtttftttttttttttttttEjtttttttttjttti;;;########################
####################################################Dj###i;f:::::::::::::::::::::::::::::::::::::::::::::::::GttttttttttttttttttttttfLttttttttttfjt;;;j########################
####################################################K###K,;tjj,::::::::::::::::::::::::::::::::::::::::::::::tttttttjtttLjtttttttttttKttttttttttGtt;D;G########################
########################################################D;;ttL;,t:::::::::::::::::::::::::::::::::::::::::::jttEttjDttttKttttttttttttLttttttttttttt;i;#########################
#########################################################;;ttLG,;,t:::::::::::::::::::::::::::::::::::::::::jjtGtttftjttDttttttttttGttttttttttttttt,;D#########################
#########################################################i,ttf::,;E::::::::::::::::::::::::::::::::::::::::LttEttttttttttttttttttttDtjtttttttttLtt;ff##########################
#########################################################L;ttj:::G:::::::::::::::::::::::::::::::::::::::::tttitttLtttttttttttttttjtjjtttttttttfjt;jE##########################
#########################################################K;ttjD:::::::::::::::::::::::::::::::::::::::::::ttjDEjttKtttttttttttttttttKjjjjjttjttjjj;############################
#########################################################K;tttt;::::::::::::::::::::::t:::::::::::::::::::ftt:tttKEtjtjDtttttttttjEtGtjtttjjjtfjjiE############################
#########################################################E;itjtj::::::::::::::::::,G.:::::::::::::::::::::tt,:tjt:ttjjtGttttttttttjttjjtjttjjtftjW#############################
#########################################################E;ittttt::::::::::::::Li::::::::::::::::::::::::ftD:KtjE,jttjtttttttttttjjfttttttjjjtjjE##############################
#########################################################D;ijjjttE;:::::::::G:::::::::::::::::::::::::::,tG::ttt:EjjtttjttttjtjttEtGttjjjtttjDK################################
#########################################################E;ijttttfDE::::::::::::::::::::::::::::::::::::ft:D;ttG:tjtjtEtttttjjtttttttttttjjKf##################################
#########################################################i;ittjtjfDfG::::::::::::::::::::::::::::::::::;j;i:ftt:,tttttjtttttttttKjKjjjtfEf#####################################
#########################################################t;ttttttfGfff:::::::::::::::::::::::::::::::::tK;:ittEGDjjtttjjttttttjttttjDL#########################################
#########################################################L;tttttGfGfffG,::::::::::::::::::::::::::::::DE;,:LtDLjtttttEttjttjtttKGD#############################################
#########################################################E;tttjtDLGfffGKf::::::::::::::::::::::::::::GGiKGGjttGEttjjjtjjjjjttK;################################################
#########################################################E;jttttfDEfffGKfi::::::::::::::::::::::::::LKEEjtDjD,,jjtjtjjttttjD###################################################
#########################################################G;jttjtfKEfffGKffK:::::::::::::::::::::::tDKDftD;tf,,:jjjjjEtttD:,K###################################################
#########################################################i;jjjjEfGEfffEEffLL:::::::::::::::::::::KEGLDi,,LE,,,DjttjttE:,,,,,###################################################
#########################################################;;jjtjfffDfffEEfffff::::::::::::::::::GEffK,,,,,G,,,,tttfE:,,,,,,,, ##################################################
#########################################################;;jjjLfffLfffEGffffff,::::::::::::::;EfLf,,,,,,W,,,,DE;,,,,,,,,,,,,D##################################################
########################################################D;tjjtKfDfffffGffEfffffG::::::::::::Dfft,,,,,,,:,,,,,,,,,,;;,,,,,,,,j##########f#######################################
#########################################################;jjtjGfGfffffLffGfLKj##L:::::::::KfLt,,,,,,,,,,,,,,,,,G;,,,,,,,,,,,,i#################################################
########################################################j;jtjiffffffffffLG#######;::::::E#:D,,,,,,,,,,,,,,,iE;;,,,;ttjffLGDEEf#################################################
########################################################,;jjGifLfGffffKG####.:#### i::E##E,,,,,,,,,,,,,,,jKGji,,,,,,,,,,,,,,,:#################################################
#############G#########################################,;tjjj fEfKffK##################K:,,,,,,,,,,,,,j;,,,,,,,,,,,,,,,,,,,,,,:W###############################################
#######################################################f;jjE#EfffGE##################D,,,,,,,,,,,,,:D,,,,,,,,,,,,,,,,,,,,,,,,,,,L##############################################
#######################################################G;jD##GDfG###################G,:;:,,,,,,,,;t,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:L#############################################
#######################################################;tj##ffE#####L###############:,fGE,,,,,,i;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:f############################################
#######################################################;t.###D#####################D,:ffD,,,,ji,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,W###########################################
######################################################K;L#####t####################K,,ffE,t:i,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, ##########################################
######################################################;G###################G#######D,,EK,:f,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,t;#########################################
#####################################################Kf#############################,,,,;,:,;iiii;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,E#########################################
#################################################### :##############################E,:E;,,,,;i;,,,,,,L;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,E########################################
####################################################D################################W;Di:,,,,,,,,,,iG,,;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,E#######################################
###################################################,,################################K,,,,,,,,,,,,,,,,,G,i,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#######################################
####################################################################################f,,,,,,,,,,,,,,,,,,,L,j,,,,,,,,,,,,,,,,,,,,,,,,,,,,,K######################################
####################################################################################;,,,,,,,,,,,,,,,,,,,,E,D,,,,,,,,,,,,,,,,,,,,,,,,,,,,GE#####################################
###################################################################################D,,,,,,,,,,,,,,,,,,,,,,L,f,,,,,,,,,,,,,,,,,,,,,,,,,,,:,j####################################
###################################################################################;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,GD###################################
**/

/** -----PRAGMA----- **/
#pragma comment(linker, "/stack:200000000")
#pragma GCC optimize("Ofast")
#pragma GCC target("sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native")

#include <iostream>
#include <vector>
#include <unordered_map>
#include <cmath>
using namespace std;

/** -----BASIC MACROES----- **/
#define endl '\n'
#define i64 long long
#define ld long double
#define pub push_back
#define mp make_pair
#define fi first
#define se second
const long long MOD = 1000000007LL, INF = 1e9, LINF = 1e18;
const long double PI = 3.141592653589793116, EPS = 1e-9, GOLD = ((1+sqrt(5))/2);
typedef vector<i64> vi;
typedef vector<ld> vd;
typedef vector<string> vs;
typedef vector<bool> vb;
typedef pair<i64, i64> pii;
typedef pair<i64, pii> pip;
typedef pair<pii, i64> ppi;

/** -----BIT CONTROLS----- **/
template<class T> int getbit(T s, int i) { return (s >> 1) & 1; }
template<class T> T onbit(T s, int i) { return s | (T(1) << i); }
template<class T> T offbit(T s, int i) { return s & (~(T(1) << i)); }
template<class T> int cntbit(T s) { return __builtin_popcount(s); }

/** -----IDEAS/ALGORITHMS-----

    -------------------------- **/

/** -----CUSTOM TYPEDEFS/DEFINES----- **/


/** -----GLOBAL VARIABLES----- **/
i64 n, q, k, u, v, x; i64 a[100009];
unordered_map<i64, i64> Map;
i64 tree1[444444], tree2[444444], lazy[444444];

/** -----EXTENSIVE FUNCTIONS----- **/
i64 Fibo(i64 x) {
	if (x < 2) return x;
	if (x == 2) return 1;
	if (Map[x] != 0) return Map[x];
	i64 tmp1 = Fibo(x/2);
	i64 tmp2 = Fibo(x/2+1);
	if (x % 2 == 0) {
		i64 res = ((tmp1 * (2 * tmp2 - tmp1)) % MOD);
		while (res < 0) res += MOD;
		Map[x] = res; return res;
	}
	Map[x] = ((tmp1 * tmp1 + tmp2 * tmp2) % MOD);
	return ((tmp1 * tmp1 + tmp2 * tmp2) % MOD);
}

void ITBuild(i64 node, i64 st, i64 en) {
	//tracker3(node, st, en);
	if (st > en) return;
	if (st == en) {
		tree1[node] = Fibo(a[st]);
		if (a[st] > 0) tree2[node] = Fibo(a[st]-1);
		else tree2[node] = -1;
		return;
	}
	ITBuild(node*2, st, (st+en)/2);
	ITBuild(node*2+1, (st+en)/2+1, en);
	tree1[node] = tree1[node*2] + tree1[node*2+1]; tree1[node] %= MOD;
	tree2[node] = tree2[node*2] + tree2[node*2+1]; tree2[node] %= MOD;
}

void ITUpdate(i64 node, i64 st, i64 en, i64 L, i64 R, i64 x) {
	if (lazy[node] != 0) {
		i64 tmp1a = tree1[node] * Fibo(lazy[node]+1); tmp1a %= MOD;
		i64 tmp1b = tree2[node] * Fibo(lazy[node]); tmp1b %= MOD;
		i64 tmp2a = tree1[node] * Fibo(lazy[node]+1-1); tmp2a %= MOD;
		i64 tmp2b = tree2[node] * Fibo(lazy[node]-1); tmp2b %= MOD;
		tree2[node] = (tmp2a + tmp2b) % MOD;
		tree1[node] = (tmp1a + tmp1b) % MOD;
		if (st != en) {
			lazy[node*2] += lazy[node];
			lazy[node*2+1] += lazy[node];
		}
		lazy[node] = 0;
	}
	if (st > en || R < st || en < L) return;
	if (L <= st && en <= R) {
		i64 tmp1a = tree1[node] * Fibo(x+1); tmp1a %= MOD;
		i64 tmp1b = tree2[node] * Fibo(x); tmp1b %= MOD;
		i64 tmp2a = tree1[node] * Fibo(x+1-1); tmp2a %= MOD;
		i64 tmp2b = tree2[node] * Fibo(x-1); tmp2b %= MOD;
		tree2[node] = (tmp2a + tmp2b) % MOD;
		tree1[node] = (tmp1a + tmp1b) % MOD;
		if (st != en) {
			lazy[node*2] += x;
			lazy[node*2+1] += x;
		}
		return;
	}
	ITUpdate(node*2, st, (st+en)/2, L, R, x);
	ITUpdate(node*2+1, (st+en)/2+1, en, L, R, x);
	tree1[node] = tree1[node*2] + tree1[node*2+1]; tree1[node] %= MOD;
	tree2[node] = tree2[node*2] + tree2[node*2+1]; tree2[node] %= MOD;
}

i64 ITGet(i64 node, i64 st, i64 en, i64 L, i64 R) {
	if (lazy[node] != 0) {
		i64 tmp1a = tree1[node] * Fibo(lazy[node]+1); tmp1a %= MOD;
		i64 tmp1b = tree2[node] * Fibo(lazy[node]); tmp1b %= MOD;
		i64 tmp2a = tree1[node] * Fibo(lazy[node]+1-1); tmp2a %= MOD;
		i64 tmp2b = tree2[node] * Fibo(lazy[node]-1); tmp2b %= MOD;
		tree2[node] = (tmp2a + tmp2b) % MOD;
		tree1[node] = (tmp1a + tmp1b) % MOD;
		if (st != en) {
			lazy[node*2] += lazy[node];
			lazy[node*2+1] += lazy[node];
		}
		lazy[node] = 0;
	}
	if (st > en || R < st || en < L) return 0;
	if (L <= st && en <= R) return tree1[node];
	i64 p1 = ITGet(node*2, st, (st+en)/2, L, R);
	i64 p2 = ITGet(node*2+1, (st+en)/2+1, en, L, R);
	return ((p1 + p2) % MOD);
}

/** -----COMPULSORY FUNCTIONS----- **/
void VarInput() {
	scanf("%lld%lld", &n, &q);
	for (i64 i=1; i<=n; i++) scanf("%lld", &a[i]);
}

void ProSolve() {
	ITBuild(1, 1, n);
	while (q--) {
		scanf("%lld", &k);
		if (k == 1) {
			scanf("%lld%lld%lld", &u, &v, &x);
			ITUpdate(1, 1, n, u, v, x);
		}
		else if (k == 2) {
			scanf("%lld%lld", &u, &v);
			printf("%lld\n", ITGet(1, 1, n, u, v));
		}
	}
	cout << endl;
}

/** -----MAIN FUNCTION----- **/
int main() {
			#ifdef Akikaze
			//freopen("FILE.OUT", "r", stdin);
			//freopen("FILE.OUT", "w", stdout);
			#endif
	VarInput();
			#ifdef Akikaze
			auto TIME1 = chrono::steady_clock::now();
			#endif
	ProSolve();
			#ifdef Akikaze
			auto TIME2 = chrono::steady_clock::now();
			auto DIFF = TIME2 - TIME1;
			cout << "\n\nTime elapsed: " << chrono::duration<double>(DIFF).count() << " seconds.";
			#endif
	return 0;
}